<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
        rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
        crossorigin="anonymous">

  <style>@page {
  size: A4 landscape;
  margin: 16mm 14mm;
}
body {
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
  color: #222;
  font-size: 12px;
  line-height: 1.45;
}
.header {
  margin-bottom: 12px;
}
h1 {
  font-size: 18px;
  margin: 0 0 6px 0;
}
h2 {
  font-size: 16px;
  margin: 20px 0 8px 0;
  page-break-after: avoid;
}
.sheet {
  break-inside: avoid;
  margin-bottom: 12px;
}
.table-wrap {
  overflow: auto;
  border: 1px solid #eaeaea;
  border-radius: 8px;
}
table {
  border-collapse: collapse;
  width: 100%;
}
th,
td {
  border: 1px solid #ddd;
  padding: 6px 8px;
  vertical-align: top;
}
th {
  background: #f7f7f7;
  font-weight: 600;
}
.caption {
  color: #666;
  font-size: 11px;
  margin-bottom: 6px;
}
.footer {
  margin-top: 16px;
  color: #777;
  font-size: 11px;
}

.grid.grid-2 {
  display: grid;
  grid-template-columns: 1.2fr 1fr;
  gap: 16px;
}

.card-title {
  font-weight: 700;
  margin-bottom: 12px;
  color: #fff;
  padding: 8px 12px;
  border-radius: 10px;
  background: linear-gradient(135deg, #ff6a6a, #ffa46a);
}
.legend {
  margin-top: 8px;
  font-size: 12px;
  color: #666;
  display: flex;
  gap: 14px;
  flex-wrap: wrap;
}
.dot {
  display: inline-block;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  margin-right: 6px;
  background: #999;
}
.dot-total {
  background: #00e6b8;
}
.dot-ans {
  background: #f7b733;
}
.dot-ivr {
  background: #ff6b81;
}
.dot-line {
  background: #3b82f6;
  border-radius: 2px;
  width: 18px;
  height: 3px;
  align-self: center;
}
table.cmp {
  width: 100%;
  border-collapse: collapse;
}
table.cmp th,
table.cmp td {
  border: 1px solid #e5e5e5;
  padding: 8px;
}
table.cmp thead th {
  background: #ffe9e1;
}
td.up {
  color: #0a8f3c;
  font-weight: 600;
}
td.down {
  color: #d14242;
  font-weight: 600;
}

/* Section header */
.kpi-note {
  margin: 8px 2px 2px;
  color: #444;
}
.kpi-note .up {
  color: #0a8f3c;
  font-weight: 600;
}
.kpi-note .down {
  color: #d14242;
  font-weight: 600;
}

/* Cards container */
.channel-cards .card {
  border: 1px solid #eee;
  border-radius: 12px;
  padding: 16px;
  margin-bottom: 12px;
}
.mini-grid {
  display: grid;
  grid-template-columns: repeat(6, minmax(140px, 1fr));
  gap: 16px;
}
.mini-card {
  border-radius: 12px;
  padding: 16px;
  background: var(--grad);
  color: #fff;
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.08);
}
.mini-title {
  display: inline-block;
  color: #eef;
  text-decoration: underline;
  margin-bottom: 6px;
}
.mini-value {
  font-size: 22px;
  font-weight: 800;
  line-height: 1.2;
}
.mini-sub {
  font-size: 12px;
  opacity: 0.95;
  margin-top: 2px;
}
.mini-delta {
  margin-top: 6px;
  font-weight: 700;
}
.mini-delta.up {
  color: #c8ffd1;
}
.mini-delta.down {
  color: #ffd1d1;
}

/* Хэвлэхэд мөр таслахгүй байхаар */
.channel-cards .mini-grid {
  break-inside: avoid;
}

.ost .card {
  border: 1px solid #eee;
  border-radius: 12px;
  padding: 16px;
} /* grid/картууд аль хэдийн байвал давхардахгүй */

.fb-wrap {
  margin-top: 18px;
  border-radius: 8px;
  overflow: hidden;
}
.fb-head {
  margin: 0;
  padding: 8px 12px;
  background: #1e40af;
  color: #fff;
}
.fb-company {
  padding: 10px 12px;
  border: 1px solid #e5e5e5;
  border-top: none;
}
.fb-company .fb-title {
  font-weight: 700;
  margin-bottom: 6px;
}
.fb-company ul {
  margin: 0;
  padding-left: 18px;
}
.fb-company li {
  margin: 2px 0;
}
.fb-company .count {
  color: #666;
  font-size: 12px;
}

.ost-top .card {
  border: 1px solid #eee;
  border-radius: 12px;
  padding: 16px;
}

.card.soft {
  padding: 12px;
}
.chart-wrap {
  break-inside: avoid;
}
.cmp {
  width: 100%;
  border-collapse: collapse;
}
.cmp th,
.cmp td {
  border: 1px solid #e5e5e5;
  padding: 8px;
  vertical-align: top;
}
.cmp thead th {
  background: #ffe9e1;
}
.cmp .num {
  text-align: right;
}
.up {
  color: #0a8f3c;
  font-weight: 600;
}
.down {
  color: #d14242;
  font-weight: 600;
}

.social .card-title {
  background: linear-gradient(135deg, #ff6a6a, #ffa46a);
  color: #fff;
}

.spacer16 {
  height: 16px;
}
</style>
</head>
<body>
 <div class="container py-3">
    <div class="row g-3">
      
  <section class="hero" style="margin-bottom:16px">
    <div style="background:linear-gradient(135deg,#ef4444,#f97316);border-radius:12px;padding:28px;display:flex;justify-content:space-between;align-items:center;min-height:220px;">
      <div style="background:#fff;border-radius:16px;padding:20px 24px;display:inline-block">
        <div style="font-weight:700;font-size:28px;letter-spacing:.5px;color:#ef4444">ARD</div>
        <div style="color:#666;margin-top:4px">Хүчтэй. Хамтдаа.</div>
      </div>
      <div style="color:#fff;text-align:right;padding:8px 16px">
        <div style="font-size:36px;font-weight:800;line-height:1.1">Ардын Тэтгэврийн Данс</div>
        <div style="opacity:.9;margin-top:8px">Долоо хоног: 07.28-08.03</div>
      </div>
    </div>
  </section>
  <section class="card">
    <div class="card-title">НИЙТ ХАНДАЛТ /Сүүлийн 4 сараар/</div>
    <canvas id="assLine"></canvas>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4"></script>
    <script>(function(){
      
    const dataLabel = { id:'dataLabel', afterDatasetsDraw(chart){
      const {ctx, data:{datasets}, scales:{x,y}} = chart;
      ctx.save(); ctx.font='12px system-ui,-apple-system,Segoe UI,Roboto,Arial'; ctx.fillStyle='#111';
      (datasets[0].data||[]).forEach((v,i)=>{ 
        const xp = x.getPixelForValue(i), yp = y.getPixelForValue(v);
        ctx.fillText(String(v), xp+6, yp-6);
      });
      ctx.restore();
    }};
  
      const ctx = document.getElementById('assLine').getContext('2d');
      new Chart(ctx, {
        type:'line',
        data:{ labels:["5 сар","6 сар","7 сар","8 сар"], datasets:[{ label:'', data:[6225,5050,5978,192], tension:.3, pointRadius:4 }] },
        options:{ animation:false, plugins:{ legend:{display:false} }, scales:{ y:{beginAtZero:true} } },
        plugins:[dataLabel]
      });
    })();</script>
  </section>
  <section class="card">
    <div class="grid">
      <div>
        <div class="card-title">БҮРТГЭЛ /Ангиллаар/</div>
        <canvas id="byCategory" style="height: 500px;"></canvas>
      </div>
      <div>
        <ul style="margin-top:34px;line-height:1.6">
          <li>Сүүлчийн 7 хоногт нийт <b>192</b> (63% лавлагаа, 26% үйлчилгээ, 11% гомдол).</li>
          <li>Өмнөх 7 хоногоос буурсан: <b>23%</b>.</li>
        </ul>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4"></script>
    <script>(function(){
      
    const dataLabel = { id:'dataLabel', afterDatasetsDraw(chart){
      const {ctx, data:{datasets}, scales:{x,y}} = chart;
      ctx.save();
      ctx.font = '12px system-ui,-apple-system,Segoe UI,Roboto,Arial';
      ctx.textAlign = 'center'; ctx.textBaseline = 'bottom';
      datasets.forEach((ds,di)=>{
        (ds.data||[]).forEach((v,i)=>{
          if(v==null) return;
          const meta = chart.getDatasetMeta(di);
          const pt = meta.data[i];
          const xPos = pt.x, yPos = pt.y - 4;
          ctx.fillStyle = '#111';
          ctx.fillText(String(v), xPos, yPos);
        });
      });
      ctx.restore();
    }};
      const ctx = document.getElementById('byCategory').getContext('2d');
      new Chart(ctx, {
        type:'bar',
        data:{
          labels:["07.14-07.20","07.21-07.27","07.28-08.03","07.28-08.03"],
          datasets:[
            { label:'Лавлагаа',   data:[31,106,135,121] },
            { label:'Үйлчилгээ',  data:[39,63,99,50] },
            { label:'Гомдол',     data:[1,5,14,21] }
          ]
        },
        options:{
          animation:false,
          plugins:{ legend:{ position:'bottom' } },
          scales:{ y:{ beginAtZero:true } }
        },
        plugins:[dataLabel]
      });
    })();</script>
  </section>
  <div class="container-fluid">
    <div class="row g-3">
      <div class="col-lg-6">
        
    <div class="card shadow-sm mb-3">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <h6 class="m-0">ЛАВЛАГАА</h6>
          <span class="badge bg-danger">
            ▼ 10%
          </span>
        </div>
        <div class="text-muted small mb-2">
          07.28-08.03: <b>135</b> &nbsp;→&nbsp;
          07.28-08.03: <b>121</b>
        </div>
        <canvas id="apsLavMini" height="140"></canvas>
      </div>
    </div>
    <script>
      (function(){
        
    const dataLabel={id:'dataLabel',afterDatasetsDraw(ch){
      const {ctx,getDatasetMeta,data:{datasets}}=ch; ctx.save();
      ctx.font='12px system-ui,-apple-system,Segoe UI,Roboto,Arial';
      ctx.textAlign='center'; ctx.textBaseline='bottom';
      datasets.forEach((ds,di)=>{const m=getDatasetMeta(di);
        (ds.data||[]).forEach((v,i)=>{if(v==null)return;const pt=m.data[i];
          ctx.fillStyle='#111'; ctx.fillText(String(v), pt.x, pt.y-6);
        });
      }); ctx.restore();
    }};
        const ctx=document.getElementById('apsLavMini').getContext('2d');
        new Chart(ctx,{
          type:'bar',
          data:{ labels:["07.28-08.03","07.28-08.03"],
                 datasets:[{label:'', data:[135,121], borderWidth:0 }]},
          options:{ animation:false, plugins:{ legend:{display:false} },
                    scales:{ y:{ beginAtZero:true } } },
          plugins:[dataLabel]
        });
      })();
    </script>
  
        
    <div class="card shadow-sm mb-3">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <h6 class="m-0">ҮЙЛЧИЛГЭЭ</h6>
          <span class="badge bg-danger">
            ▼ 49%
          </span>
        </div>
        <div class="text-muted small mb-2">
          07.28-08.03: <b>99</b> &nbsp;→&nbsp;
          07.28-08.03: <b>50</b>
        </div>
        <canvas id="apsUilMini" height="140"></canvas>
      </div>
    </div>
    <script>
      (function(){
        
    const dataLabel={id:'dataLabel',afterDatasetsDraw(ch){
      const {ctx,getDatasetMeta,data:{datasets}}=ch; ctx.save();
      ctx.font='12px system-ui,-apple-system,Segoe UI,Roboto,Arial';
      ctx.textAlign='center'; ctx.textBaseline='bottom';
      datasets.forEach((ds,di)=>{const m=getDatasetMeta(di);
        (ds.data||[]).forEach((v,i)=>{if(v==null)return;const pt=m.data[i];
          ctx.fillStyle='#111'; ctx.fillText(String(v), pt.x, pt.y-6);
        });
      }); ctx.restore();
    }};
        const ctx=document.getElementById('apsUilMini').getContext('2d');
        new Chart(ctx,{
          type:'bar',
          data:{ labels:["07.28-08.03","07.28-08.03"],
                 datasets:[{label:'', data:[99,50], borderWidth:0 }]},
          options:{ animation:false, plugins:{ legend:{display:false} },
                    scales:{ y:{ beginAtZero:true } } },
          plugins:[dataLabel]
        });
      })();
    </script>
  
        
    <div class="card shadow-sm mb-3">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <h6 class="m-0">ГОМДОЛ</h6>
          <span class="badge bg-success">
            ▲ 50%
          </span>
        </div>
        <div class="text-muted small mb-2">
          07.28-08.03: <b>14</b> &nbsp;→&nbsp;
          07.28-08.03: <b>21</b>
        </div>
        <canvas id="apsGomMini" height="140"></canvas>
      </div>
    </div>
    <script>
      (function(){
        
    const dataLabel={id:'dataLabel',afterDatasetsDraw(ch){
      const {ctx,getDatasetMeta,data:{datasets}}=ch; ctx.save();
      ctx.font='12px system-ui,-apple-system,Segoe UI,Roboto,Arial';
      ctx.textAlign='center'; ctx.textBaseline='bottom';
      datasets.forEach((ds,di)=>{const m=getDatasetMeta(di);
        (ds.data||[]).forEach((v,i)=>{if(v==null)return;const pt=m.data[i];
          ctx.fillStyle='#111'; ctx.fillText(String(v), pt.x, pt.y-6);
        });
      }); ctx.restore();
    }};
        const ctx=document.getElementById('apsGomMini').getContext('2d');
        new Chart(ctx,{
          type:'bar',
          data:{ labels:["07.28-08.03","07.28-08.03"],
                 datasets:[{label:'', data:[14,21], borderWidth:0 }]},
          options:{ animation:false, plugins:{ legend:{display:false} },
                    scales:{ y:{ beginAtZero:true } } },
          plugins:[dataLabel]
        });
      })();
    </script>
  
      </div>
      <div class="col-lg-6">
        
  <section class="company-top10">
    
    <div class="card soft">
      <div class="card-title">ТОП ЛАВЛАГАА / туслах ангилалаар /</div>
      <div class="tables">
        <div class="card soft">
    <table class="cmp">
      <thead>
        <tr><th>Туслах ангилал</th><th>07.28-08.03</th><th>08.04-08.10</th><th>Өөрчлөлт</th></tr>
      </thead>
      <tbody>
        
          <tr>
            <td>Данс цуцлах заавар</td>
            <td class="num">67</td>
            <td class="num">64</td>
            <td class="num down">▼ 4%</td>
          </tr>
        
          <tr>
            <td>Орлого хийх заавар</td>
            <td class="num">18</td>
            <td class="num">14</td>
            <td class="num down">▼ 22%</td>
          </tr>
        
          <tr>
            <td>Тэтгэврийн хуримтлал барьцаалсан зээл</td>
            <td class="num">13</td>
            <td class="num">10</td>
            <td class="num down">▼ 23%</td>
          </tr>
        
          <tr>
            <td>Ерөнхий мэдээлэл өгсөн</td>
            <td class="num">9</td>
            <td class="num">6</td>
            <td class="num down">▼ 33%</td>
          </tr>
        
          <tr>
            <td>Орлого орсон эсэх</td>
            <td class="num">9</td>
            <td class="num">4</td>
            <td class="num down">▼ 56%</td>
          </tr>
        
          <tr>
            <td>Тэтгэврийн хуримтлалын данс нээх</td>
            <td class="num">1</td>
            <td class="num">3</td>
            <td class="num up">▲ 200%</td>
          </tr>
        
          <tr>
            <td>Хуримтлал багцын мэдээлэл</td>
            <td class="num">1</td>
            <td class="num">3</td>
            <td class="num up">▲ 200%</td>
          </tr>
        
          <tr>
            <td>Тэтгэврийн хуримтлалын автомат таталтын тохиргоо хийх заавар</td>
            <td class="num">0</td>
            <td class="num">3</td>
            <td class="num up">▲ 100%</td>
          </tr>
        
          <tr>
            <td>Дансны хуулга авах заавар</td>
            <td class="num">3</td>
            <td class="num">2</td>
            <td class="num down">▼ 33%</td>
          </tr>
        
          <tr>
            <td>Хуримтлалын үлдэгдэл шалгах заавар</td>
            <td class="num">2</td>
            <td class="num">2</td>
            <td class="num up">▲ 0%</td>
          </tr>
        
      </tbody>
    </table></div>
      </div>
    </div>
    
    <div class="card soft">
      <div class="card-title">ТОП ҮЙЛЧИЛГЭЭ / туслах ангилалаар /</div>
      <div class="tables">
        <div class="card soft">
    <table class="cmp">
      <thead>
        <tr><th>Туслах ангилал</th><th>07.28-08.03</th><th>08.04-08.10</th><th>Өөрчлөлт</th></tr>
      </thead>
      <tbody>
        
          <tr>
            <td>Хуримтлал цуцлах</td>
            <td class="num">59</td>
            <td class="num">47</td>
            <td class="num down">▼ 20%</td>
          </tr>
        
          <tr>
            <td>Коммент hide хийсэн</td>
            <td class="num">0</td>
            <td class="num">2</td>
            <td class="num up">▲ 100%</td>
          </tr>
        
          <tr>
            <td>Тэтгэврийн хуримтлал цуцлах материал хүлээн авсан</td>
            <td class="num">0</td>
            <td class="num">1</td>
            <td class="num up">▲ 100%</td>
          </tr>
        
          <tr>
            <td>Орлого хийх дансны дугаар</td>
            <td class="num">40</td>
            <td class="num">0</td>
            <td class="num down">▼ 100%</td>
          </tr>
        
      </tbody>
    </table></div>
      </div>
    </div>
    
    <div class="card soft">
      <div class="card-title">ТОП ГОМДОЛ / туслах ангилалаар /</div>
      <div class="tables">
        <div class="card soft">
    <table class="cmp">
      <thead>
        <tr><th>Туслах ангилал</th><th>07.28-08.03</th><th>08.04-08.10</th><th>Өөрчлөлт</th></tr>
      </thead>
      <tbody>
        
          <tr>
            <td>Данс хаах хүсэлт хугацаандаа шийдвэрлэгдээгүй</td>
            <td class="num">2</td>
            <td class="num">10</td>
            <td class="num up">▲ 400%</td>
          </tr>
        
          <tr>
            <td>Хаагдсан дансруу авто таталт хийгдсэн</td>
            <td class="num">3</td>
            <td class="num">5</td>
            <td class="num up">▲ 67%</td>
          </tr>
        
          <tr>
            <td>Хуримтлал барьцаалсан зээл хугацаандаа шийлвэрлэгдээгүй</td>
            <td class="num">1</td>
            <td class="num">2</td>
            <td class="num up">▲ 100%</td>
          </tr>
        
          <tr>
            <td>Орлого ороогүй</td>
            <td class="num">0</td>
            <td class="num">2</td>
            <td class="num up">▲ 100%</td>
          </tr>
        
          <tr>
            <td>Хуримтлал барьцаалсан зээл авч болохгүй</td>
            <td class="num">1</td>
            <td class="num">1</td>
            <td class="num up">▲ 0%</td>
          </tr>
        
          <tr>
            <td>1 хувийн ард койн олгогдоогүй</td>
            <td class="num">0</td>
            <td class="num">1</td>
            <td class="num up">▲ 100%</td>
          </tr>
        
          <tr>
            <td>Данс шилжүүлэх хүсэлт хугацаандаа шийдвэрлээгүй</td>
            <td class="num">1</td>
            <td class="num">0</td>
            <td class="num down">▼ 100%</td>
          </tr>
        
          <tr>
            <td>Дансны мэдээлэл харагдахгүй</td>
            <td class="num">3</td>
            <td class="num">0</td>
            <td class="num down">▼ 100%</td>
          </tr>
        
          <tr>
            <td>Андуурсан гүйлгээний мөнгө буцаагдаагүй</td>
            <td class="num">3</td>
            <td class="num">0</td>
            <td class="num down">▼ 100%</td>
          </tr>
        
      </tbody>
    </table></div>
      </div>
    </div>
  </section>
      </div>
    </div>
  </div>
  <div class="row g-3">
    <div class="col-lg-6">
      <div class="card shadow-sm">
        <div class="card-header text-center fw-semibold" 
             style="background:#f6c342;color:#4a3d00;border-top-left-radius:.5rem;border-top-right-radius:.5rem">
          OUTBOUND
        </div>
        <div class="card-body p-0">
          <table class="table table-bordered table-striped mb-0 align-middle">
            <thead class="table-light text-center">
              <tr>
                <th style="width:28%">Огноо</th>
                <th style="width:24%">Залгалт</th>
                <th style="width:24%">Амжилттай</th>
                <th style="width:24%">SR</th>
              </tr>
            </thead>
            <tbody>
              
                <tr>
                  <td>5/20</td>
                  <td class="text-end">147</td>
                  <td class="text-end">64</td>
                  <td class="text-end">44%</td>
                </tr>
                <tr>
                  <td>5/21</td>
                  <td class="text-end">239</td>
                  <td class="text-end">125</td>
                  <td class="text-end">52%</td>
                </tr>
                <tr>
                  <td>5/22</td>
                  <td class="text-end">141</td>
                  <td class="text-end">71</td>
                  <td class="text-end">50%</td>
                </tr>
                <tr>
                  <td>5/23</td>
                  <td class="text-end">239</td>
                  <td class="text-end">122</td>
                  <td class="text-end">51%</td>
                </tr>
                <tr>
                  <td>5/24</td>
                  <td class="text-end">79</td>
                  <td class="text-end">33</td>
                  <td class="text-end">42%</td>
                </tr>
                <tr>
                  <td>5/25</td>
                  <td class="text-end">126</td>
                  <td class="text-end">54</td>
                  <td class="text-end">43%</td>
                </tr>
              <tr class="fw-bold">
                <td>Нийт</td>
                <td class="text-end">971</td>
                <td class="text-end">469</td>
                <td class="text-end">48%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Хүсвэл баруун талд (col-lg-6) өсөлт/бууралтын график эсвэл өөр блок тавина -->
    <div class="col-lg-6">
      <div class="card h-100">
        <div class="card-header fw-semibold">Өсөлт / бууралт</div>
        <div class="card-body">
          <canvas id="outboundTrend" height="180"></canvas>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4"></script>
  <script>
    (function(){
      const ctx = document.getElementById('outboundTrend').getContext('2d');
      new Chart(ctx,{
        type:'bar',
        data:{
          labels:["5/20","5/21","5/22","5/23","5/24","5/25"],
          datasets:[
            {label:'Залгалт', data:[147,239,141,239,79,126]},
            {label:'Амжилттай', data:[64,125,71,122,33,54]}
          ]
        },
        options:{animation:false, plugins:{legend:{position:'bottom'}}, scales:{y:{beginAtZero:true}}}
      });
    })();
  </script>
      <div class="footer">Автоматаар бэлтгэсэн тайлан (Node.js)</div>
    </div>
  </div>
</body>
</html>